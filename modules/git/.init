#!/usr/bin/env sh

GITUTILS_HOME="$(dirname "$0")"

export LOG_NAMESPACE="󰊢 git"
export LOG_LEVEL=info

# ╭───┤ Expose scripts 
# ╰─

scripts_home="$GITUTILS_HOME/scripts"
fancy-log info -v path "$scripts_home" "Scripts exposed in \$PATH"
export PATH="$scripts_home:$PATH"

# ╭───┤ Patch git config 
# ╰─

fake="$HOME/.gitconfig"
real="$GITUTILS_HOME/config/.gitconfig"

if is_symlink_broken "$fake"; then
  fancy-log warn -v path "$fake" \
    "Removing broken config symlink ..."

  rm "$fake"
fi

if [ ! -e "$fake" ]; then
  fancy-log info -v real "$real" -v fake "$fake" \
    "Creating config symlink ..."

  ln -s "$real" "$fake"
fi
